<!DOCTYPE html>
<!--suppress ALL -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>mathematicalModeling</title>
    <link href="../static/css/code.css" rel="stylesheet" type="text/css">
    <style>
        .tit{
            text-align:center;
        }
        div{
            font-size:20px;
        }
    </style>
</head>
<body>
    <div class="tit">
        <span style="color:red;font-size:40px;">曲线拟合问题</span>
    </div>
    <ol type="I">
        <li>
            <div>这里由于没有数据，先生成实验数据</div>
            <div>首先目标曲线：</div>
            <div><img src="../static/Math/mathematicalModeling/1.png"></div>
            <div><img src="../static/Math/mathematicalModeling/2.png"></div>
            <div>生成曲线数据方法如下：</div>
            <pre id="code_block">
                <span><code>import numpy as np</code></span>
                <span><code>import matplotlib.pyplot as plt</code></span>
                <span><code>from scipy.stats import norm</code></span>
                <span><code></code></span>
                <span><code>def function(x, a , b, f, phi):</code></span>
                <span><code>    result = a * np.exp(-b * np.sin(f * x + phi))</code></span>
                <span><code>    return result</code></span>
                <span><code></code></span>
                <span><code>x = np.linspace(0, 2 * np.pi, 50)</code></span>
                <span><code>actual_parameters = [3, 2, 1.25, np.pi / 4]</code></span>
                <span><code>y = function(x, *actual_parameters)</code></span>
                <span><code>y_noisy = y + 0.8 * norm.rvs(size=len(x))</code></span>
            </pre>
            <div>生成数据如下：</div>
            <table border="4">
                <tr>
                    <th>X</th>
                    <th>y</th>
                </tr>
                <tr>
                    <td>0.2236457993127439</td>
                    <td>0.0</td>
                </tr>
                <tr>
                    <td>1.4472239795989474</td>
                    <td>0.1282282715750936</td>
                </tr>
                <tr>
                    <td>1.5792959120790648</td>
                    <td>0.2564565431501872</td>
                </tr>
                <tr>
                    <td>0.6778526748445148</td>
                    <td>0.3846848147252807</td>
                </tr>
                <tr>
                    <td>-0.6797746530946486</td>
                    <td>0.5129130863003744</td>
                </tr>
                <tr>
                    <td>-1.345488810309232</td>
                    <td>0.6411413578754679</td>
                </tr>
                <tr>
                    <td>0.4305698669877983</td>
                    <td>0.7693696294505615</td>
                </tr>
                <tr>
                    <td>0.2225439327873096</td>
                    <td>0.8975979010256552</td>
                </tr>
                <tr>
                    <td>0.5563458625209984</td>
                    <td>1.0258261726007487</td>
                </tr>
                <tr>
                    <td>0.9735430216325486</td>
                    <td>1.1540544441758422</td>
                </tr>
                <tr>
                    <td>1.6505242044568138</td>
                    <td>1.2822827157509358</td>
                </tr>
                <tr>
                    <td>2.2295451677583267</td>
                    <td>1.4105109873260295</td>
                </tr>
                <tr>
                    <td>1.628960353649783</td>
                    <td>1.538739258901123</td>
                </tr>
                <tr>
                    <td>0.9288338406419172</td>
                    <td>1.6669675304762166</td>
                </tr>
                <tr>
                    <td>2.2110209441001736</td>
                    <td>1.7951958020513104</td>
                </tr>
                <tr>
                    <td>3.999369944623464</td>
                    <td>1.923424073626404</td>
                </tr>
                <tr>
                    <td>3.9376386726741193</td>
                    <td>2.0516523452014974</td>
                </tr>
                <tr>
                    <td>4.657941910308808</td>
                    <td>2.179880616776591</td>
                </tr>
                <tr>
                    <td>7.331812028544913</td>
                    <td>2.3081088883516845</td>
                </tr>
                <tr>
                    <td>9.774651123767196</td>
                    <td>2.436337159926778</td>
                </tr>
                <tr>
                    <td>13.072575654860648</td>
                    <td>2.564565431501872</td>
                </tr>
                <tr>
                    <td>16.046094983549896</td>
                    <td>2.692793703076965</td>
                </tr>
                <tr>
                    <td>18.481085161260022</td>
                    <td>2.821021974652059</td>
                </tr>
                <tr>
                    <td>19.58699050741213</td>
                    <td>2.9492502462271526</td>
                </tr>
                <tr>
                    <td>22.04319094067442</td>
                    <td>3.077478517802246</td>
                </tr>
                <tr>
                    <td>22.02385348945999</td>
                    <td>3.20570678937734</td>
                </tr>
                <tr>
                    <td>20.503432658529263</td>
                    <td>3.333935060952433</td>
                </tr>
                <tr>
                    <td>18.85461977186076</td>
                    <td>3.4621633325275267</td>
                </tr>
                <tr>
                    <td>16.802089091952716</td>
                    <td>3.5903916041026207</td>
                </tr>
                <tr>
                    <td>13.11532042210773</td>
                    <td>3.718619875677714</td>
                </tr>
                <tr>
                    <td>11.297549961853283</td>
                    <td>3.846848147252808</td>
                </tr>
                <tr>
                    <td>7.747740727077016</td>
                    <td>3.975076418827901</td>
                </tr>
                <tr>
                    <td>5.728927390707121</td>
                    <td>4.103304690402995</td>
                </tr>
                <tr>
                    <td>5.125876657542555</td>
                    <td>4.231532961978089</td>
                </tr>
                <tr>
                    <td>3.378692145170281</td>
                    <td>4.359761233553182</td>
                </tr>
                <tr>
                    <td>2.7147610622780087</td>
                    <td>4.487989505128276</td>
                </tr>
                <tr>
                    <td>2.305721533048369</td>
                    <td>4.616217776703369</td>
                </tr>
                <tr>
                    <td>0.8972099977883041</td>
                    <td>4.744446048278463</td>
                </tr>
                <tr>
                    <td>-0.1996605132227342</td>
                    <td>4.872674319853556</td>
                </tr>
                <tr>
                    <td>1.243082834436828</td>
                    <td>5.00090259142865</td>
                </tr>
                <tr>
                    <td>-0.1275325117242889</td>
                    <td>5.129130863003743</td>
                </tr>
                <tr>
                    <td>1.0871655290227444</td>
                    <td>5.257359134578837</td>
                </tr>
                <tr>
                    <td>-0.7857412983994341</td>
                    <td>5.385587406153931</td>
                </tr>
                <tr>
                    <td>0.7708997393738456</td>
                    <td>5.513815677729024</td>
                </tr>
                <tr>
                    <td>0.6419152273260361</td>
                    <td>5.642043949304118</td>
                </tr>
                <tr>
                    <td>-0.2359115509562813</td>
                    <td>5.770272220879211</td>
                </tr>
                <tr>
                    <td>0.443110821073647</td>
                    <td>5.898500492454305</td>
                </tr>
                <tr>
                    <td>1.4139827980946416</td>
                    <td>6.026728764029398</td>
                </tr>
                <tr>
                    <td>0.6262415653904855</td>
                    <td>6.154957035604492</td>
                </tr>
                <tr>
                    <td>1.1785639400214245</td>
                    <td>6.283185307179586</td>
                </tr>
            </table>
            <div><img src="../static/Math/mathematicalModeling/3.png"></div>
        </li>
        <li>
            <div>最小二乘法拟合</div>
            <pre id="code_block">
                <span><code>from scipy.optimize import curve_fit</code></span>
                <span><code>p_est,err_est = curve_fit(function, x, y_noisy)</code></span>
                <span><code>print(p_est)</code></span>
            </pre>
            <div>我们得到了系数的解</div>
            <table border="4">
                <tr>
                    <th>参数</th>
                    <th>计算得到的</th>
                    <th>原函数</th>
                </tr>
                <tr>
                    <td>a</td>
                    <td>3.12367656</td>
                    <td>3</td>
                </tr>
                <tr>
                    <td>b</td>
                    <td>1.9478261</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>f</td>
                    <td>1.28744683</td>
                    <td>1.25</td>
                </tr>
                <tr>
                    <td>phi</td>
                    <td>0.6444031</td>
                    <td>0.7853981</td>
                </tr>
            </table>
            <div><img src="../static/Math/mathematicalModeling/4.png"></div>
        </li>
        <li>
            <div>误差分析</div>
            <pre id="code_block">
                <span><code>print(err_est)</code></span>
            </pre>
            <div>可以得到协方差矩阵</div>
            <img src="../static/Math/mathematicalModeling/5.png">
        </li>
    </ol>
</body>
</html>